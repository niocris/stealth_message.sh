#!/bin/bash

# --- ИМЯ: stealth_message.sh ---
# Описание: Скрипт, который адаптирует вывод Base64 в зависимости от среды GitHub.

# Исходное сообщение
SECRET_MESSAGE="Этот скрипт работает в окружении GitHub Actions!"

# 1. Проверяем переменную окружения GITHUB_ACTIONS
# Переменная GITHUB_ACTIONS устанавливается в 'true' внутри workflow.
if [ "$GITHUB_ACTIONS" = "true" ]; then
    
    # --- СРЕДА GITHUB ACTIONS (Режим "Человек") ---
    
    echo "--- Скрипт обнаружен: GitHub Actions ---"
    
    # Выводим сообщение в чистом виде для удобства разработчика в логах.
    echo "Статус: Успешно. Сообщение в чистом виде:"
    echo "$SECRET_MESSAGE"
    
else
    
    # --- ЛОКАЛЬНАЯ СРЕДА (Режим "Скрытность") ---
    
    echo "--- Скрипт запущен локально ---"
    
    # Кодируем сообщение в Base64.
    # Используем -n, чтобы избежать добавления новой строки в конце
    ENCODED_MESSAGE=$(echo -n "$SECRET_MESSAGE" | base64)
    
    echo "Статус: Вывод закодирован для безопасности/скрытности (Base64):"
    echo "$ENCODED_MESSAGE"
    
    echo ""
    echo "--- Дополнительно: Декодируем для проверки (только локально) ---"
    echo "$ENCODED_MESSAGE" | base64 -d
    echo "--------------------------------------------------------"
fi

exit 
